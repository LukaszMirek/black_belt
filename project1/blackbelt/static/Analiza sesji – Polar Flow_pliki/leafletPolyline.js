!function(){LPolyline=function(e,i,t,s){var o=e.map;this.colors={border:"white",background:CommonHelpers.routeDefaultColor,highlight:i},this.zIndex=t,this.points=s,this.markers=null,this.borderPolyline=null,this.highlightPolyline=null,this.bgBeforePolyline=null,this.bgAfterPolyline=null,this.startIndex=null,this.stopIndex=null;var n=this.renderMarkers(e,s);this.borderPolyline=new L.Polyline(this.points,{color:this.colors.border,weight:7.5,smoothFactor:1,zIndex:this.zIndex}).addTo(o),this.setSelectedRange(e,0,s.length-1,n)},LPolyline.prototype.renderMarkers=function(e,i){var t=e.map;if(e.model.club&&e.model.club.clubTrainingSession){var s=e.model.club,o=new L.LatLng(s.latitude,s.longitude),n="<h4>"+s.clubName+"</h4><p>"+s.clubAddress+"</p>",r=new L.Icon({iconUrl:s.clubLogoUrl,iconSize:[35,35],iconAnchor:[17.5,17.5],popupAnchor:[0,-20]});return L.marker(o,{icon:r}).addTo(t).bindPopup(n).openPopup(),t.setView(o),!1}var l=e.model.exercises;l&&Object.keys(l).length>1&&$.each(l,function(s,o){o[ExerciseKeys.HAS_SAMPLES]&&(o[ExerciseKeys.IS_FIRST]||L.marker(i[o[ExerciseKeys.SAMPLES_START_INDEX]],{icon:e.icons.intermediate}).addTo(t),o[ExerciseKeys.IS_LAST]||L.marker(i[o[ExerciseKeys.SAMPLES_STOP_INDEX]],{icon:e.icons.intermediate}).addTo(t),e.model.samples&&e.model.samples.length>0&&e.model.samples.length<10&&L.marker(i[o[ExerciseKeys.SAMPLES_START_INDEX]],{icon:e.icons.global}).addTo(t))}),this.startIcon=L.marker(i[0],{icon:e.icons.start}).addTo(t),this.endIcon=L.marker(i[i.length-1],{icon:e.icons.end}).addTo(t);var a=e.selectedExercise;if(a){var h=a[ExerciseKeys.RACE_PACE_END_INDEX];null!=h&&this.points[h]&&(this.racePaceEndIcon=L.marker(this.points[h],{icon:e.icons.racepaceEnd,zIndexOffset:200}).addTo(t))}return!0},LPolyline.prototype.getBounds=function(){return this.highlightPolyline?this.highlightPolyline.getBounds():this.borderPolyline?this.borderPolyline.getBounds():null},LPolyline.prototype.setSelectedRange=function(e,i,t,s){var o=e.map;if(null!=i&&null!=t?(this.startIndex=i,this.stopIndex=t):(this.startIndex=0,this.stopIndex=this.points.length-1),this.removeLayers(o),this.startIndex>0){var n=this.points.slice(0,this.startIndex+1);this.bgBeforePolyline=new L.Polyline(n,{color:this.colors.background,weight:2.5,smoothFactor:1,zIndex:this.zIndex+1}).addTo(o)}var r=this.points.length-1;if(this.stopIndex<r){var l=this.points.slice(this.stopIndex,r+1);this.bgAfterPolyline=new L.Polyline(l,{color:this.colors.background,weight:2.5,smoothFactor:1,zIndex:this.zIndex+1}).addTo(o)}var a=this.points.slice(this.startIndex,this.stopIndex+1);if(e.highlightType.format?this.highlightPolyline=L.multiOptionsPolyline(a,{multiOptions:e.highlightType.format,weight:2.5,smoothFactor:1,zIndex:this.zIndex+2}).addTo(o):this.highlightPolyline=new L.Polyline(a,{color:this.colors.highlight,weight:2.5,smoothFactor:1,zIndex:this.zIndex+2}).addTo(o),this.markers&&this.markers.forEach(function(e){o.removeLayer(e)},this),e.markers&&e.showMarkers)switch(e.markers){case Markers.laps:this.renderLaps(e);break;case Markers.phases:this.renderPhases(e)}s&&o.fitBounds(this.highlightPolyline.getBounds(),{padding:[LMapConstants.FIT_BOUNDS_PADDING,LMapConstants.FIT_BOUNDS_PADDING]})},LPolyline.prototype.removeLayers=function(e){this.bgBeforePolyline&&e.removeLayer(this.bgBeforePolyline),this.bgAfterPolyline&&e.removeLayer(this.bgAfterPolyline),this.highlightPolyline&&e.removeLayer(this.highlightPolyline)},LPolyline.prototype.renderLaps=function(e){e.selectedLaps&&(this.markers=[],e.selectedLaps.forEach(function(i){var t=Math.min(this.points.length-1,i.lapSampleIndex);if(this.points[t]){var s=L.marker(this.points[t],{icon:new L.MarkerIcon({className:"polar-marker-icon polar-marker-icon__lap",shadowUrl:null,text:""+i.lapNumber,iconUrl:AppGlobal.imagesUrl+"map_icons/map-_lap-marker.svg"}),zIndexOffset:100}).addTo(e.map);this.markers.push(s)}},this))},LPolyline.prototype.renderPhases=function(e){e.selectedLaps&&(this.markers=[],e.selectedLaps.forEach(function(i){var t=Math.min(this.points.length-1,i.lapSampleIndex);if(this.points[t]){var s=L.marker(this.points[t],{icon:new L.MarkerIcon({className:"polar-marker-icon polar-marker-icon__phase",shadowUrl:null,text:""+i.lapNumber,iconUrl:AppGlobal.imagesUrl+"map_icons/map-phase-marker.svg"}),zIndexOffset:100}).addTo(e.map);this.markers.push(s)}},this))}}();
//# sourceMappingURL=leafletPolyline.min.js.map